@using IronBoots.Models.Products
@model ProductViewModel

@{
    ViewData["Title"] = "Add Product";
}

<div>
    <h2>Add New Product</h2>

    <form asp-action="Add">
        <div class="form-group">
            <label for="Name">Name</label>
            <input type="text" id="Name" name="Name" class="form-control" />
        </div>

        <div class="form-group">
            <label for="ImageUrl">Image URL</label>
            <input type="text" id="ImageUrl" name="ImageUrl" class="form-control" />
        </div>

        <div class="form-group">
            <label for="Price">Price</label>
            <input type="text" id="Price" name="Price" class="form-control" />
        </div>

        <div class="form-group">
            <label for="Weight">Weight (kg)</label>
            <input type="number" id="Weight" name="Weight" class="form-control" />
        </div>

        <div class="form-group">
            <label for="Size">Size (cm³)</label>
            <input type="number" id="Size" name="Size" class="form-control" />
        </div>

        <div class="form-group">
            <label for="ProductionCost">Production Cost</label>
            <input type="text" id="ProductionCost" name="ProductionCost" class="form-control" />
        </div>

        <div class="form-group">
            <label for="ProductionTime">Production Time (hh:mm:ss)</label>
            <input type="text" id="ProductionTime" name="ProductionTime" class="form-control" />
        </div>

        <div class="form-group">
            <h3>Materials Required</h3>
            <ul class="list-unstyled">
                @foreach (var material in Model.Materials)
                {
                    <li>
                        <div class="form-check">
                            <input type="checkbox" class="form-check-input material-checkbox" data-material-id="@material.Id" id="material-@material.Id" />
                            <label class="form-check-label" for="material-@material.Id">@material.Name</label>
                        </div>
                        <input type="number" class="form-control mt-2" id="quantity-@material.Id" name="MaterialQuantities[@material.Id]" placeholder="Quantity" disabled />
                    </li>
                }
            </ul>
        </div>

        <button type="submit" class="btn btn-primary">Save</button>
        <button type="button" class="btn btn-secondary">Cancel</button>
    </form>
</div>

@section Scripts {
    <script>
        document.addEventListener('DOMContentLoaded', function () {
            document.querySelectorAll('.material-checkbox').forEach(function (checkbox) {
                checkbox.addEventListener('change', function () {
                    const quantityBox = document.querySelector(`#quantity-${this.dataset.materialId}`);
                    if (this.checked) {
                        quantityBox.removeAttribute('disabled');
                    } else {
                        quantityBox.setAttribute('disabled', 'true');
                        quantityBox.value = '';
                    }
                });
            });
        });
    </script>
}
